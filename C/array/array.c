#include<stdio.h>
#include<string.h>
#include"array.h"
#include"help.h"

#define len 20

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 array average function : A function that        	          **
**		takes:                                                    **
**			1- Input array  2-size of array     		       	  **
**		returns:                                                  **
**			 the average of array elements						  **
********************************************************************/


int average_arr (int * arr , int size)
{
	int i,sum=0,avg ;
	
	for (i=0 ; i< size ; i++)
	{
		/*saving the sum after adding array elements each iteration*/
		sum=sum+arr[i];
	}
	
	/*after exiting the loop calculate */
	avg = sum / size ; 
	
	
	return avg ; 
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 swap two arrays  function : A function that 		          **
**		takes:                                                    **
**			1- Input array1  2-size of array 3- same size of both **
**		returns:                                                  **
**			 the both arrays swapped							  **
********************************************************************/



void swap_array(int * arr1 , int * arr2 , int size )
{
	
	int i;
	for(i=0 ; i< size ; i++)
	{
		
		swap (&arr1[i] ,&arr2[i]);
		
	}
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 check string letters  function : A function that 		      **
**		takes:                                                    **
**			1- Input string	 2- size				    		  **
**		returns:                                                  **
**			 true-> letters are distinct-false _>repeated letters **
********************************************************************/


int check_string_letters( char str[] , int size)
{
	/*two counters i to hold a letter , j to check on the remaing letters */
	int i , j , flag=0;
	
	/*outer for loop to hold a certain letter*/
	for(i=0 ; i<size ; i++ )
	{
		
		/*inner for loop to check on other letters */
		for(j=i+1 ; j< size ; j++)
		{
			
			if( str[i] == str[j])
			{
				
				flag= 1;
				
			}
		}
	}
	return flag ; 
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 convert lowercase to uppercase  function : A function that   **
**		takes:                                                    **
**			1- Input string 2- size								  **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/


void lowercase_to_uppercase(char *str , int size)
{
	int i;
	
	for(i=0 ; i< size ; i++)
	{
		*(str+i)=*(str+i)-('a'-'A');
		//str[i]=str[i]-('a'-'A');
		
	}

	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 Reverse array  function : A function that   				  **
**		takes:                                                    **
**			1- Input string 2- size								  **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/


void reverse_array(int * arr , int size)
{
	
	int i , j ; 

	j=size-1;
	
	for (i=0 ; i <(size/2) ; i++)
	{
		swap(&arr[i],&arr[j]);
		j--;
	}
	
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 Reverse array  function : A function that   				  **
**		takes:                                                    **
**			1- Input string 2- size								  **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/



int letter_frequency(char *str,int size, char lett)
{
	
	int i , ctr=0;
	for(i=0 ; i< size ; i++)
	{
		if(  *(str+i) == lett  )
		{
			ctr++;
		}
	}
	
	
	return ctr;
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 Remove_Non_Alphabet  function : A function that   		     **
**		takes:                                                    **
**			1- Input string 2- size								  **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/



void Remove_Non_Alphabet(char *str)
{
	
	int i , j; 
	for ( i = 0 ; str[i] != '\0'; i++) 
	{

      // enter the loop if the character is not an alphabet and not the null character
     
      while (!(str[i] >= 'a' && str[i] <= 'z') && !(str[i] >= 'A' && str[i] <= 'Z') && !(str[i] == '\0'))
	  {
		  
		  /*loop for deleting and reaarranging executes only if a non alphabet is found  */
         for (j = i; str[j] != '\0'; j++) 
		 {
			/*overwrite on non alphabet place*/
            str[j] = str[j + 1];
         }
         str[j] = '\0';
      }
	  
   }
   
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 get_string_length  function : A function that   			  **
**		takes:                                                    **
**			1- Input string     								  **
**		returns:                                                  **
**			 length  											  **
********************************************************************/



int get_string_length(char*str)
{
	int ctr=0 	;
	
	while (str[ctr]!= '\0')
	{
		
		ctr++;
	}
	
	return ctr;
	
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 Reverse a string  function : A function that   			  **
**		takes:                                                    **
**			1- Input string 2- size								  **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/


void reverse_string(char* str, int size)
{
	int i=1,j=0 ;
	char temp;

		
		for(j=0 ; j<(size/2) ; j++)
		{
			temp= str[size-i];
			str[size-i] = str[j];
			str[j]=temp;
			
			i++;
			
		}
	
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

/*******************************************************************
**	 Reverse a string  function : A function that   			  **
**		takes:                                                    **
**			1- Input string 2- size								  **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/



void concat_string(char *str, int size, char*str2,int size2)
{
	int i =0, j;
	
	for(i=0; str[i]!='\0'  ; i++);

	
	for(j=0 ; str2[j]!='\0' ; j++)
	{
		
		*(str+i) = *(str2+j);
		i++;
		
	}
	str[i]='\0';
	
	
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 insert element function : A function that   			      **
**		takes:                                                    **
**			1- Input array  2- inserted value 3- position		  **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/



void insert_element ( int * arr , int size,int element , int pos )
{
	
	int i ; 
	
	/*shiting array elements right to get a room for the inserted element*/
	for(i=size ; i >= pos ; i--)
	{
		arr[i]= arr[i-1];
	}
	
	/*assign the added element value  at the needed pos */
	arr[pos-1]= element;
	size++;
	

}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 insert element function : A function that   			      **
**		takes:                                                    **
**			1- Input array  2- inserted value 3- position 4-size  **
**		returns:                                                  **
**			 pointer to int array								  **
********************************************************************/

int* insert_element2 ( int*arr ,int size,int element ,int pos)
{
	/*static to not be deleted after function terminates*/
	static int arr2[len] ;
	int	i , temp , j; 
	
	for(i = 0 , j=0 ; i <= size ; i++)
	{
		if ( i == pos )
		{
			arr2[i] = element;
		
		}
		else
		{
			arr2[i] =arr[j];
			j++;
		}

	}
	return arr2;
	
	
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 delete element function : A function that   			      **
**		takes:                                                    **
**			1- Input array  2-position		                      **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/



void delete_element ( int *arr , int size , int del)
{
	
	int i ;
	
	for(i= del-1 ; i < size ; i++ )
	{
		arr[i]= arr[i+1];
	}
	size--;
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 delete element function : A function that   			      **
**		takes:                                                    **
**			1- Input array  2-position		                      **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/

void string_dictionary_order( char str[5][30] , char temp[30] )
{
	
	int i = 0, j;
	
	
	   for (i = 0; i < 5; ++i) 
	   {
			for (j = i + 1; j < 5; ++j)
			{
				if (strcmp(str[i], str[j]) > 0) 
				{
					strcpy(temp, str[i]);
					strcpy(str[i], str[j]);
					strcpy(str[j], temp);
					
				}
				
			}
			
			
	   }
	
	
}



/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 found at  function : A function that       			      **
**		takes:                                                    **
**			1- Input array  2-size 3- element 4- receive pointer  **
**		returns:                                                  **
**			 pointer to array of integers			    		  **
********************************************************************/



int* found_at (int *arr1 , int size , int element , int* rp)
{
	int i, ctr=0;
	static int indces[len];
	
	for(i=0 ; i < size ; i++)
	{
		if(*(arr1+i) == element)
		{
			
			indces[ctr]=i+1;
			ctr++;
			
		}
		
	}
	
	*rp = ctr;
	
	if( ctr == 0 )
	{
		
		printf("not found\n");
		return 0;
	}
	else
	{
		return indces ; 
	}
	
	
}


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 delete element function : A function that   			      **
**		takes:                                                    **
**			1- Input array  2-receive pointer1 3- rp  4-size      **
**		returns:                                                  **
**			 nothing											  **
********************************************************************/



void greatest_smallest_element( int*arr ,int *rp1 , int*rp2 , int size)
{
	int i ;
	
	*rp1 = *(arr+0);
	*rp2 = *(arr+0);
		
	for(i=0 ; i<size ; i++)
	{
		if(*(arr+i) > *rp1)
		{
			*rp1= *(arr+i); 
		}
		if(*(arr+i)< *rp2 )
		{
			
			*rp2=*(arr+i);
		}
		
	}
	
	
	
}



/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 selection sorting function : A function that   		      **
**		takes:                                                    **
**			1- Input array  2-size   						      **
**		returns:                                                  **
**			 nothing		                                      **
** -->find the smallest , place it at the proper position		  **
********************************************************************/



void selection_sort (int *arr , int size)
{
	int i , j , temp ;
	
	int min_index;
	
	/*outer for loop for pass sequence*/
	for(i=0 ; i< size-1 ; i++ )
	{
		min_index = i;
		
		/*inner for loop for getting the smallest*/
		for(j=i+1 ; j< size ; j++)
		{
			/*change < to > to swich between asc. and desc. orders*/
			if(arr[j] < arr[min_index])
			{
				min_index= j;
			}
		}
		
		/*check that the smallest value is not at the first index 
		as if it was at first index i , no nedd for swapping */
		if(min_index != i)
		{
			/*swapping*/
			temp= arr[min_index];
			arr[min_index]=arr[i];
			arr[i]=temp;
		}
		
		
		
	}
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 Bubble sorting function : A function that   		          **
**		takes:                                                    **
**			1- Input array  2-size   						      **
**		returns:                                                  **
**			 nothing		                                      **
--> compare each element with each adjacent , swap if not orderd  **
********************************************************************/



void bubble_sort (int *arr , int size)
{
	
	int i , j , temp;
	
	/*outer for loop for pass sequence*/
	
	for(i=0 ; i< size-1 ; i++)
	{
		
		/*inner for loop to compare each 2 adjacents and swap if needed*/
		for(j=0 ; j<size-i-1 ; j++)
		{
			/*compare each element with its adjacent*/
			if(arr[j] > arr[j+1])
			{
				/*swap*/
				temp= arr[j+1];
				arr[j+1]=arr[j];
				arr[j]=temp;
			}
		}
	}
	
	
	
	
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 Insertion sorting function : A function that   	          **
**		takes:                                                    **
**			1- Input array  2-size   						      **
**		returns:                                                  **
**			 nothing		                                      **
--> divide the array into two parts : 1 sorted part 			  **
	2- insorted part , each iteration , we insert the first 	  **
	unsorted element into the sorted part 						  **
********************************************************************/



void insertion_sort(int *arr , int size)
{
	int i,j,key;
	
	/*outer for loop (unsorted part(left)), begins with 1 as 0 is the only sorted element in the sorted part*/
	for(i=1 ; i< size ; i++)
	{
		
		/*save the first unsorted element in the key */
		key=arr[i];
		
		/*save the last sorted element*/
		j=i-1;
		
		
		/*inner for loop to compare the key with each element in the sorted part(right) */
		while(  (arr[j] > key) && (j>=0) )
		{
			/*shift the current element one place to the right( overwrite on key )*/
			arr[j+1] = arr[j];
			
			j--;
		}
		
		/*insert the key in its proper position in sorted part*/
		arr[j+1]=key;
		
		
	}		
	
	
}




/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 Binary Search function : A function that   	  	          **
**		takes:                                                    **
**			1- Input array  2-value    						      **
**		returns:                                                  **
**			 the index at which the value is existing		      **
**																  **
********************************************************************/


int binary_search(int *arr , int size , int val )
{
	
	int first=0 , last=size-1 , flag=0 ,mid;
	
	while(first<= last)
	{
		mid=(first+last)/2;
		
		if(val ==arr[mid])
		{
			flag=1;
			break;
		}
		else if (val >arr[mid])
		{
			first=mid+1;
		}
		else if (val< arr[mid])
		{
			last=mid-1;
		}
		
	}
	
	if(flag == 1)
	{
		printf("\nThe value %d is found at the index %d", val , mid+1);
		return mid+1;
	}
	else
	{
		printf("\n%d Not found in the list !!",val);
		return 0;
	}
		
}



/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 Linear Search function : A function that   	  	          **
**		takes:                                                    **
**			1- Input array  2-value    						      **
**		returns:                                                  **
**			 the index at which the value is existing		      **
**																  **
********************************************************************/



int linear_search(int *arr , int size , int val )
{
	int i , flag=0 ;
	
	for(i=0 ; i< size ; i++)
	{
		if( arr[i] == val)
		{
			flag=1;
			break;
			
			
		}
		
		
	}
	
	if(flag ==1 )
	{
		return i+1;
	}
	else
	{
		return 0;
	}

	
}



/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 Merge Sort function : A function that   	  	              **
**		takes:                                                    **
**		  1- Input array1  2-Input array2 3-result array 4-sizes  **
**		returns:                                                  **
**		 Nothing						     					  **
**																  **
********************************************************************/



void merge_sort(int*arr1 , int*arr2 ,int *res_arr ,int size1 , int size2)
{
	/* i,j for the iinput arrays , k is for the result array*/
	int i=0 , j=0 ,k=0;
	
	
	/*loop until any array of them is finished */
	while(i<size1  && j <size2)
	{
		/*compare each element in arr1 to its opponent element in arr2*/
		if(arr1[i]<= arr2[j])
		{
			/*insert from arr1 */
			res_arr[k]=arr1[i];
			
			/*increment its counter*/
			i++;
			
			/*increment the result array counter*/
			k++;
			
		}
		else if(arr2[j]<=arr1[i])
		{
			/*insert from arr2*/
			res_arr[k]=arr2[j];
			
			/*increment its counter*/
			j++;
			
			/*increment the result array counter*/
			k++;
		}
	}
	
	/*check if arr1 is not finished yet*/
	while(i<size1)
	{
		/*insert from arr1 */
		res_arr[k]=arr1[i];
			
		/*increment its counter*/
		i++;
			
		/*increment the result array counter*/
		k++;
	}
	
	/*check if arr2 is not finished yet*/
	while(j<size2)
	{
		/*insert from arr1 */
		res_arr[k]=arr2[j];
			
		/*increment its counter*/
		j++;
			
		/*increment the result array counter*/
		k++;
	}
	
	
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	 Merge Sorted parts function : A function that   	  	      **
**		takes:                                                    **
**		  1-Input array 2-result array 3-low1 4-up1 5-low2 6-up2  **
**		returns:                                                  **
**		 Nothing						     					  **
**																  **
********************************************************************/


void merge_sorted_parts(int*arr , int *res_arr ,int low1 , int low2 , int up1 , int up2)
{
	int   i=low1 , j=low2 ,k=low1 ;
	
	while(i<=up1 && j<=up2)
	{
		
		if(arr[i]<= arr[j])
		{
			res_arr[k]=arr[i];;
			i++;
			k++;
		}
		else
		{
			res_arr[k]=arr[j];;
			j++;
			k++;
		}

	}
	
	while(i<= up1)
	{
			res_arr[k]=arr[i];;
			i++;
			k++;
	}
	
	while(j<= up2)
	{
			res_arr[k]=arr[j];;
			j++;
			k++;
	}
	
	
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	Iterative Merge Sorting  function : A function that 	      **
**		takes:                                                    **
**		  	1-													  **
**		returns:                                                  **
**		 	Nothing						     					  **
**																  **
********************************************************************/




/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	Sell Sorting  function : A function that 		  	  	      **
**		takes:                                                    **
**		  	1-													  **
**		returns:                                                  **
**		 	Nothing						     					  **
**																  **
********************************************************************/










/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	Get missing elelment  function : A function that 		  	  **
**		takes:                                                    **
**		  	1- input integer array 2- size						  **
**		returns:                                                  **
**		 	 the missing number 							      **
**																  **
********************************************************************/


int missing_element ( int * arr , int size)
{
	
	int i , missing, actual_sum =0,expected_sum , n ; 
	
	
	for(i=0 ; i< size ; i++)
	{
		actual_sum=actual_sum+arr[i];	
	}
	
	n=size+1;
	expected_sum=(n*(n+1))/2;

	printf("\nactual=%d\nexpexted=%d", actual_sum,expected_sum);

	missing=expected_sum-actual_sum;
	
	
	return missing;
}

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
/*******************************************************************
**	Get Duplicate elelment  function : A function that 		  	  **
**		takes:                                                    **
**		  	1- input integer array 2- size						  **
**		returns:                                                  **
**		 	the duplicate number							      **
**																  **
********************************************************************/
void duplicate_element (int *arr ,int size )
{
	int i ,j ;

	
	for(i=0 ; i< size ; i++)
	{
		for(j=i+1 ; j< size ; j++)
		{
			if(arr[i]==arr[j])
			{
				printf("%d\t",arr[i]);
			}
			
		}
	}
	
	
	
}



void first_last_occurance(int* arr , int size , int val , int* ptr1 , int* ptr2)
{
	
	int i , first=-1 , last=-1 ; 
	
	
	for( i =0 ; i< size ; i++)
	{
		if( val == arr[i])
		{
			if(first == -1)
			{
				/*first is assigned once*/
				first=i;
				last=i;
			}
			else
			{
				/*update the last only*/
				last=i;
			}
			
		}
		
	}
	if(first != -1)
	{
		*ptr1=first;
		*ptr2=last;
		
	}
	else
	{
		printf("\nthe element is not found in the array ");
	}
	
	
	
	
	
	
	
}